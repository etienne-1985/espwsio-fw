checkoutLocation: "./esp32-toolkit-lib"
workspaceLocation: "."
tasks:
  - name: Workspace Setup
    env:  
      PROJECT_ARTIFACT_URL: 'https://github.com/etienne1911/esp32-toolkit-lib/releases/download'
      PROJECT_ARTIFACT_REL: 'r1'
      PROJECT_ARTIFACT_NAME: 'pio-workspace-artifact' #esp32-pio-workspace
      SCRIPTS_DIR: src/modules/pwa-tools/scripts/
    init: |
      wget $PROJECT_ARTIFACT_URL/$PROJECT_ARTIFACT_REL/$PROJECT_ARTIFACT_NAME.zip
      echo 'workspace artifact retrieved'
      unzip ${PROJECT_ARTIFACT_NAME}.zip
      echo 'done extracting workspace artifact'
      pwd && ls -la
      rm -rf lib/esp32-toolkit-lib/ && mv esp32-toolkit-lib/ lib/
      ln -s lib/esp32-toolkit-lib/examples/firmware-base.cpp src/main.cpp
      python -m pip install --upgrade pip
      pip install --upgrade platformio
    command: |
      cd /workspace
      # rm src/main.cpp && ln -s lib/esp32-toolkit-lib/examples/firmware-base.cpp src/main.cpp && pio run 